import{_ as S,T as L,S as x}from"./index-24b5c249.js";import{I as K,r as p,o as l,a as n,d as c,b as t,w as b,x as u,y as I,K as r,L as _,O as g,C,M as P,e as h,f as v}from"./calendar.esm-ab6b2a00.js";import k from"./MemberInfoView-f8f0e6c3.js";const d="https://stage.westar-cms.com/v1/withdraw",M={name:"MemberCashView",components:{TopHeader:L,Sidebar:x,paginate:K,MemberInfoView:k},data(){return{idLists:[],startKey:"",userAppId:"",cashState:"",isSearched:!1,isError:!1,errorMessage:"",selectedState:"all",filteredList:[],customers:null,selectedIdType:"",cashId:this.$route.params.cashId,error:null,withdrawals:[],isLastPage:"",isPrevPage:"",withdrawalsCashList:[],prevStartKey:null}},mounted(){this.getMembers(),this.onStateChange(),this.getWithdrawals()},methods:{async getMembers(){const e=await this.$http.get(d);this.idLists=e.data.data.cashList,this.startKey=e.data.data.startKey,this.filteredList=this.idLists,this.withdrawals=this.filteredList},onStateChange(){this.filteredList=this.selectedState==="all"?this.idLists:this.idLists.filter(e=>e.cashState===this.selectedState),console.log(this.filteredList)},searchUser(){this.isSearched=!0,this.$http.get(d).then(e=>{this.userAppId||this.cashState?this.filteredList=this.idLists.filter(s=>(!this.userAppId||s.userAppId===this.userAppId)&&(!this.cashState||s.cashState===this.cashState)):this.filteredList=[],console.log(e.data.data)})},limitInput(){const e=this.userAppId.length;e<10?(this.isError=!0,this.errorMessage="請至少輸入10位數字!"):e>10?(this.isError=!0,this.errorMessage="不能輸入超過10位數字!"):this.isError=!1},reloadPage(){window.location.reload()},async showDetail(e){this.cashId=this.$refs.id,this.$router.push({name:"MemberCashInfo",params:{cashId:e}})},async getWithdrawals(){try{const e=await this.$http.get(d);this.filteredList=e.data.data.cashList,this.withdrawalsCashList=e.data.data.cashList,this.startKey=e.data.data.startKey,this.isPrevPage=null,this.prevStartKey=this.startKey,this.startKey||(this.isLastPage=!0)}catch(e){console.error(e)}},async getNextWithdrawals(){try{if(this.isLastPage)return;const e=await this.$http.get(d+`?startKey=${this.startKey}`);e.data.data&&(this.filteredList=e.data.data.cashList,this.withdrawalsCashList=e.data.data.cashList,this.startKey=e.data.data.startKey,this.prevStartKey=this.startKey,this.startKey||(this.isLastPage=!0))}catch(e){console.error(e)}},async getPrevWithdrawals(){try{const e=await this.$http.get(d+`?startKey=${this.startKey}`);e.data.data&&(this.filteredList=e.data.data.cashList,this.withdrawalsCashList=e.data.data.cashList,this.prevStartKey=e.data.data.prevStartKey,e.data.data.prevStartKey?this.prevStartKey=e.data.data.prevStartKey:this.prevStartKey=null,this.isLastPage=!1)}catch(e){console.error(e)}},async prevPage(){try{if(!this.prevStartKey)return;const e=await this.$http.get(d+`?startKey=${this.prevStartKey}`);this.data=e.data.data;const s=this.prevStartKey;this.prevStartKey=this.startKey,this.startKey=s,this.isLastPage=!1}catch(e){console.error(e)}}}},A={class:"wrapper"},V={class:"page-content-wrapper"},T={class:"container-fluid"},N={class:"row"},E={class:"col-lg-12"},D={class:"bg-light pt-2 pb-2 rounded","aria-label":"breadcrumb"},U={class:"breadcrumb d-flex align-items-center mb-0 px-2"},W=t("li",{class:"breadcrumb-item active","aria-current":"page"}," 提領狀態列表 ",-1),j=t("div",null,[t("h2",{class:"text-primary mt-4 fs-3 fw-bold"},"提領狀態")],-1),B=t("div",null,[t("h2",{class:"text-primary mt-4 fs-5 fw-bold"},"搜尋會員")],-1),H={class:"mb-4"},z={class:"fs-6 border border-1 rounded-4 pt-4"},F={class:"d-flex align-items-center align-items-sm-start pb-4 flex-column flex-lg-row p-2"},O={class:"col-12 col-lg-4 mb-2"},q={class:"d-flex"},G=t("label",{for:"userAppId",class:"col-auto col-form-label me-2 ms-1"},"星行號",-1),J={key:0,class:"text-danger text-end"},Q={class:"col-12 col-lg-4 mb-2"},R={class:"d-flex"},X=t("label",{for:"specificSizeSelect",class:"col-auto col-form-label me-2 ms-1"},"提領狀態",-1),Y=v('<option disabled value="">選擇類型</option><option value="審核中">審核中</option><option value="處理中">處理中</option><option value="提領成功">提領成功</option><option value="提領失敗">提領失敗</option>',5),Z=[Y],$={class:"col-12 d-flex justify-content-center mb-4"},tt={class:""},et={class:"d-flex justify-content-between align-items-center mb-2"},st=t("div",null,[t("h2",{class:"text-primary mt-4 fs-5 fw-bold"},"提領狀態")],-1),at={class:"d-flex align-items-center;"},it={class:"row g-3 align-items-center"},ot=t("div",{class:"col-auto"},[t("label",{for:"inputType",class:"col-form-label"},"提領狀態")],-1),rt={class:"col-auto"},lt=["value"],nt=v('<option value="all">所有類型</option><option value="審核中">審核中</option><option value="處理中">處理中</option><option value="提領成功">提領成功</option><option value="提領失敗">提領失敗</option>',5),dt=[nt],ct={class:"table-responsive"},ht={class:"table table-bordered align-middle"},pt=t("thead",{class:"table-primary"},[t("tr",null,[t("th",{scope:"col"},"#"),t("th",{scope:"col"},"申請日期"),t("th",{scope:"col"},"星行號"),t("th",{scope:"col"},"提領金額"),t("th",{scope:"col"},"提領狀態"),t("th",{scope:"col"},"提領單號"),t("th",{scope:"col"},"狀態")])],-1),ut={class:"table-group-divider"},_t={scope:"row"},mt={id:"cash-state"},ft=["onClick","id"],bt=t("i",{class:"bi bi-eye-fill"},null,-1),gt={key:0,class:"text-center h4 fs-bold mt-4 mb-4 text-primary"},vt=t("p",null,[t("i",{class:"bi bi-binoculars"}),h(" 找不到結果，麻煩您重新再輸入一次 ! ")],-1),yt={class:"d-flex justify-content-center flex-column flex-lg-row"},wt={class:"pagination d-flex justify-content-center"};function St(e,s,Lt,xt,i,o){const y=p("Sidebar"),w=p("TopHeader"),m=p("router-link");return l(),n("div",A,[c(y),t("div",V,[t("div",T,[t("div",N,[t("section",E,[c(w),t("nav",D,[t("ol",U,[c(m,{to:"/dshboard",class:"breadcrumb-item"},{default:b(()=>[h("首頁")]),_:1}),c(m,{to:"/member-control",class:"breadcrumb-item"},{default:b(()=>[h("會員管理")]),_:1}),W])]),j,B,t("div",H,[t("form",z,[t("div",F,[t("div",O,[t("div",q,[G,u(t("input",{type:"text",id:"userAppId",class:"form-control",placeholder:"1234567890","onUpdate:modelValue":s[0]||(s[0]=a=>i.userAppId=a),onInput:s[1]||(s[1]=(...a)=>o.limitInput&&o.limitInput(...a))},null,544),[[I,i.userAppId]])]),i.isError?(l(),n("div",J,r(i.errorMessage),1)):_("",!0)]),t("div",Q,[t("div",R,[X,u(t("select",{class:"form-select",id:"specificSizeSelect","onUpdate:modelValue":s[2]||(s[2]=a=>i.cashState=a)},Z,512),[[g,i.cashState]])])])]),t("div",$,[t("button",{type:"button",class:"btn btn-primary text-white mx-2",onClick:s[3]||(s[3]=a=>o.searchUser())}," 搜尋 ")])])]),t("div",tt,[t("div",et,[st,t("div",at,[t("div",it,[ot,t("div",rt,[u(t("select",{"onUpdate:modelValue":s[4]||(s[4]=a=>i.selectedState=a),onChange:s[5]||(s[5]=(...a)=>o.onStateChange&&o.onStateChange(...a)),class:"form-select","aria-label":"Default select example",value:i.selectedState===""?null:i.selectedState},dt,40,lt),[[g,i.selectedState]])])])])]),t("div",ct,[t("table",ht,[pt,t("tbody",ut,[(l(!0),n(C,null,P(i.filteredList,(a,f)=>(l(),n("tr",{key:f},[t("th",_t,r(f+1),1),t("td",null,r(a.date),1),t("td",null,r(a.userAppId),1),t("td",null,r(a.cashMoney),1),t("td",null,r(a.cashState),1),t("td",null,r(a.cashId),1),t("td",mt,[t("button",{onClick:Kt=>o.showDetail(a.cashId),id:a.cashId,class:"btn btn-info text-light mb-2"},[bt,h("檢視 ")],8,ft)])]))),128))])])]),!i.filteredList.length&&i.isSearched?(l(),n("div",gt,[vt,t("div",yt,[t("button",{class:"btn btn-primary text-light mb-2",onClick:s[6]||(s[6]=a=>o.reloadPage())}," 重新搜尋 ")])])):_("",!0)]),t("div",wt,[t("button",{class:"pagination-item btn btn-outline-primary pagebtn",onClick:s[7]||(s[7]=a=>o.reloadPage())}," 重新整理 "),i.isLastPage?_("",!0):(l(),n("button",{key:0,class:"pagination-item btn btn-outline-primary pagebtn",onClick:s[8]||(s[8]=a=>o.getNextWithdrawals())},"下一頁"))])])])])])])}const kt=S(M,[["render",St]]);export{kt as default};
