import{_ as w,T as x,S as K}from"./index-24b5c249.js";import{I as P,r as p,J as L,o as r,a as i,d as h,b as t,w as m,x as b,y as S,K as l,L as u,e as c,C as I,M as k}from"./calendar.esm-ab6b2a00.js";const A="/starcreated-cms/assets/img-user-3513de9f.svg",C="/starcreated-cms/assets/img-login-bg-97bbd245.png",d="https://stage.westar-cms.com/v1/member",M={name:"Member",components:{TopHeader:x,Sidebar:K,paginate:P},data(){return{members:[],statusText:{false:"未認證",true:"已認證"},nullText:{null:"無帳號"},filteredList:[],userAppId:"",realNameState:"",isSearched:!1,isError:!1,errorMessage:"",currentPage:1,perPage:10,pageCount:0,startKey:"",paginatedData:[],withdrawals:[],isLastPage:"",isPrevPage:"",withdrawalsUsers:[],prevStartKey:null}},mounted(){this.getMembers(),this.getWithdrawals()},computed:{paginatedList(){const s=(this.currentPage-1)*this.perPage,a=s+this.perPage;return this.filteredList.slice(s,a)},prevPageStartKey(){return this.startKey!==""?this.startKey:this.prevStartKey}},methods:{async getMembers(){const s=await this.$http.get(d);this.startKey=s.data.data.startKey,this.filteredList=s.data.data.userList,this.withdrawals=this.filteredList,this.pageCount=Math.ceil(this.filteredList.length/this.perPage),this.filteredList},async searchUser(){try{const s=await this.$http.get(d+`?userAppId=${this.userAppId}`);s.data.data.userList&&(this.withdrawals=s.data,this.withdrawalsUsers=s.data.data.userList,this.prevuserAppId=this.userAppId,this.userAppId||(this.isLastPage=!0),this.isSearched=!0,this.userAppId?this.filteredList=this.members.filter(a=>!this.userAppId||a.userAppId===this.userAppId):this.filteredList=[])}catch(s){console.error(s)}},limitInput(){const s=this.userAppId.length;s<10?(this.isError=!0,this.errorMessage="請至少輸入10位數字!"):s>10?(this.isError=!0,this.errorMessage="不能輸入超過10位數字!"):this.isError=!1},reloadPage(){window.location.reload()},updatePaginatedData(){const s=(this.currentPage-1)*this.perPage,a=s+this.perPage;this.paginatedData=this.filteredList.slice(s,a)},async onPageChange(s){this.currentPage=s,await this.getList()},async getWithdrawals(){try{const s=await this.$http.get(d);this.withdrawals=s.data,this.withdrawalsUsers=s.data.data.userList,this.startKey=s.data.data.startKey,this.isPrevPage=null,this.prevStartKey=this.startKey,this.startKey||(this.isLastPage=!0)}catch(s){console.error(s)}},async getNextWithdrawals(){try{if(this.isLastPage)return;const s=await this.$http.get(d+`?startKey=${this.startKey}`);s.data.data&&(this.withdrawals=s.data,this.withdrawalsUsers=s.data.data.userList,this.startKey=s.data.data.startKey,this.prevStartKey=this.startKey,this.startKey||(this.isLastPage=!0))}catch(s){console.error(s)}},async getPrevWithdrawals(){try{const s=await this.$http.get(d+`?startKey=${this.startKey}`);s.data.data&&(this.withdrawals=s.data,this.withdrawalsUsers=s.data.data.userList,this.prevStartKey=s.data.data.prevStartKey,s.data.data.prevStartKey?this.prevStartKey=s.data.data.prevStartKey:this.prevStartKey=null,this.isLastPage=!1)}catch(s){console.error(s)}},async prevPage(){try{if(!this.prevStartKey)return;const s=await this.$http.get(d+`?startKey=${this.prevStartKey}`);this.withdrawals=s.data,this.withdrawalsUsers=s.data.data.userList,this.startKey=s.data.data.startKey,s.data.data.prevStartKey?this.prevStartKey=s.data.data.prevStartKey:this.prevStartKey=null,this.isLastPage=!1}catch(s){console.error(s)}}}},T={class:"wrapper"},U={class:"page-content-wrapper"},N={class:"container-fluid"},V={class:"row"},D={class:"col-lg-12"},E={class:"bg-light pt-2 pb-2 rounded","aria-label":"breadcrumb"},W={class:"breadcrumb d-flex align-items-center mb-0 px-2"},j=t("li",{class:"breadcrumb-item active","aria-current":"page"}," 會員管理 ",-1),B=t("div",null,[t("h2",{class:"text-primary mt-4 fs-3 fw-bold"},[t("span",null,[t("i",{class:"bi bi-person-fill fs-3 text-secondary"})]),c(" 會員管理 ")])],-1),H=t("div",null,[t("h2",{class:"text-primary mt-4 fs-5 fw-bold"},"搜尋會員")],-1),$={class:"col-12 mb-4"},F={class:"fs-6"},J={class:"d-flex align-items-center align-items-sm-start border border-1 rounded-4 pt-4 pb-4 pb-lg-0 flex-column flex-lg-row"},q=t("div",{class:"col-auto"},[t("label",{for:"userAppId",class:"col-form-label me-2 ms-1"},"星行號")],-1),z={class:"col-md-4 mb-4"},G={key:0,class:"text-danger text-end"},O={class:"col-auto"},Q=["disabled"],R={class:"col-lg-12"},X=t("div",null,[t("h2",{class:"text-primary mt-4 fs-5 fw-bold"},"會員列表")],-1),Y={class:"table-responsive"},Z={class:"table table-bordered align-middle star-table"},tt=t("thead",{class:"table-primary"},[t("tr",null,[t("th",{scope:"col"},"#"),t("th",{scope:"col"},"星行號"),t("th",{scope:"col"},"暱稱"),t("th",{scope:"col",class:"text-center"},"頭像"),t("th",{scope:"col",class:"text-center"},"背景圖"),t("th",{scope:"col"},"帳號"),t("th",{scope:"col"},"實名認證"),t("th",{scope:"col"},"操作"),t("th",{scope:"col"},"註冊方式")])],-1),st={class:"table-group-divider"},et={scope:"row"},at={class:"d-flex justify-content-center"},rt={key:0,src:A,alt:"img-404",class:"rounded-circle img-user"},it=["src"],ot={class:"d-flex justify-content-center"},lt={key:0,class:"img-user-bg",src:C,alt:"img-404"},nt=["src"],dt={key:0},ct={key:1},ht={id:"cash-state"},pt=t("i",{class:"bi bi-person-gear"},null,-1),ut={key:0,class:"text-center h4 fs-bold mt-4 mb-4 text-primary"},gt=t("p",null,[t("i",{class:"bi bi-binoculars"}),c(" 找不到結果，麻煩您重新再輸入一次! ")],-1),_t={class:"d-flex justify-content-center flex-column flex-lg-row"},mt={class:"pagination d-flex justify-content-center"};function bt(s,a,yt,ft,o,n){const y=p("Sidebar"),f=p("TopHeader"),g=p("router-link"),v=L("tooltip");return r(),i("div",T,[h(y),t("div",U,[t("div",N,[t("div",V,[t("section",D,[h(f),t("nav",E,[t("ol",W,[h(g,{to:"/dshboard",class:"breadcrumb-item"},{default:m(()=>[c("首頁")]),_:1}),j])]),B,H,t("div",$,[t("form",F,[t("div",J,[q,t("div",z,[b(t("input",{type:"text",id:"userAppId",class:"form-control",placeholder:"1234567890","onUpdate:modelValue":a[0]||(a[0]=e=>o.userAppId=e),onInput:a[1]||(a[1]=(...e)=>n.limitInput&&n.limitInput(...e))},null,544),[[S,o.userAppId]]),o.isError?(r(),i("div",G,l(o.errorMessage),1)):u("",!0)]),t("div",O,[b((r(),i("button",{type:"button",class:"btn btn-primary text-white mx-2","data-bs-dismiss":"modal",onClick:a[2]||(a[2]=e=>n.searchUser()),disabled:o.userAppId===""},[c(" 搜尋 ")],8,Q)),[[v,"請新輸入星行者號碼"]])])])])])]),t("div",R,[X,t("div",Y,[t("table",Z,[tt,t("tbody",st,[(r(!0),i(I,null,k(o.withdrawalsUsers,(e,_)=>(r(),i("tr",{key:_},[t("th",et,l(_+1),1),t("td",null,l(e.userAppId),1),t("td",null,l(e.nickname),1),t("td",null,[t("div",at,[e.avatar===""?(r(),i("img",rt)):(r(),i("img",{key:1,src:e.avatar,alt:"img-user",class:"rounded-circle img-user"},null,8,it))])]),t("td",null,[t("div",ot,[e.background===""?(r(),i("img",lt)):(r(),i("img",{key:1,class:"img-user-bg",src:e.background,alt:"img-user-bg"},null,8,nt))])]),e.account==="null"?(r(),i("td",dt,l(o.nullText[e.account]),1)):(r(),i("td",ct,l(e.account),1)),t("td",null,l(o.statusText[e.realNameVerify]),1),t("td",ht,[h(g,{to:"/member-control",class:"btn btn-info text-light"},{default:m(()=>[pt,c(" 管理 ")]),_:1})]),t("td",null,l(e.loginType),1)]))),128))])])]),!o.withdrawalsUsers.length&&o.isSearched?(r(),i("div",ut,[gt,t("div",_t,[t("button",{class:"btn btn-primary text-light mb-2",onClick:a[3]||(a[3]=e=>n.reloadPage())}," 重新搜尋 ")])])):u("",!0)]),t("div",null,[t("div",mt,[t("button",{class:"pagination-item btn btn-outline-primary pagebtn",onClick:a[4]||(a[4]=e=>n.reloadPage())}," 重新整理 "),o.isLastPage?u("",!0):(r(),i("button",{key:0,class:"pagination-item btn btn-outline-primary pagebtn",onClick:a[5]||(a[5]=e=>n.getNextWithdrawals())},"下一頁"))])])])])])])}const xt=w(M,[["render",bt]]);export{xt as default};
